<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Real FFT Functions &mdash; NMSIS 1.2.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Real FFT F16 Functions" href="realfft/api_realfftf16.html" />
    <link rel="prev" title="MFCC Q31" href="mfcc/api_mfccq31.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html">
            <img src="../../../_static/nmsis_logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.2.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/introduction.html">Nuclei MCU Software Interface Standard(NMSIS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../core/index.html">NMSIS Core</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">NMSIS DSP</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../get_started.html">Using NMSIS-DSP</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">NMSIS DSP API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../api_groupmath.html">Basic Math Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupbayes.html">Bayesian estimators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupcmplxmath.html">Complex Math Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupcontroller.html">Controller Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupdistance.html">Distance functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupfastmath.html">Fast Math Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupfilters.html">Filtering Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupinterpolation.html">Interpolation Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupmatrix.html">Matrix Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupquaternionmath.html">Quaternion Math Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupstats.html">Statistics Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupsupport.html">Support Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupsvm.html">SVM Functions</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../api_grouptransforms.html">Transform Functions</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="api_complexfft.html">Complex FFT Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_dct4_idct4.html">DCT Type IV Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="api_mfcc.html">MFCC</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Real FFT Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_realfftf16.html">Real FFT F16 Functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_realfftf64.html">Real FFT F64 Functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_realfftq15.html">Real FFT Q15 Functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_realfftq31.html">Real FFT Q31 Functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_realfft_table.html">Real FFT Tables</a></li>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_realfftf32.html">Real FFT F32 Functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="realfft/api_deprecatedrealfft.html">Deprecated Real FFT Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupwindow.html">Window Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_groupexamples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../nn/index.html">NMSIS NN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../appendix.html">Appendix</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">NMSIS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">NMSIS DSP</a> &raquo;</li>
          <li><a href="../index.html">NMSIS DSP API</a> &raquo;</li>
          <li><a href="../api_grouptransforms.html">Transform Functions</a> &raquo;</li>
      <li>Real FFT Functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/dsp/api/grouptransforms/api_realfft.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="real-fft-functions">
<span id="nmsis-dsp-api-real-fft-functions"></span><h1>Real FFT Functions<a class="headerlink" href="#real-fft-functions" title="Permalink to this headline"></a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_realfftf16.html">Real FFT F16 Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_realfftf64.html">Real FFT F64 Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_realfftq15.html">Real FFT Q15 Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_realfftq31.html">Real FFT Q31 Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_realfft_table.html">Real FFT Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_realfftf32.html">Real FFT F32 Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="realfft/api_deprecatedrealfft.html">Deprecated Real FFT Functions</a></li>
</ul>
</div>
<dl>
<dt class="sig sig-object cpp">
<span class="target" id="group__RealFFT"></span><em><span class="pre">group</span></em> <span class="sig-name descname"><span class="pre">RealFFT</span></span></dt>
<dd><p><dl class="simple">
<dt><strong></strong></dt><dd><p>The NMSIS DSP library includes specialized algorithms for computing the FFT of real data sequences. The FFT is defined over complex data but in many applications the input is real. Real FFT algorithms take advantage of the symmetry properties of the FFT and have a speed advantage over complex algorithms of the same length. </p>
</dd>
<dt><strong></strong></dt><dd><p>The Fast RFFT algorithm relays on the mixed radix CFFT that save processor usage. </p>
</dd>
<dt><strong></strong></dt><dd><p>The real length N forward FFT of a sequence is computed using the steps shown below. </p>
</dd>
<dt><strong></strong></dt><dd><p><img alt="../../../_images/RFFT.png" src="../../../_images/RFFT.png" /></p>
</dd>
<dt><strong></strong></dt><dd><p>The real sequence is initially treated as if it were complex to perform a CFFT. Later, a processing stage reshapes the data to obtain half of the frequency spectrum in complex format.</p>
</dd>
<dt><strong></strong></dt><dd><p>The input for the inverse RFFT should keep the same format as the output of the forward RFFT. A first processing stage pre-process the data to later perform an inverse CFFT. </p>
</dd>
<dt><strong></strong></dt><dd><p><img alt="../../../_images/RIFFT.png" src="../../../_images/RIFFT.png" /></p>
</dd>
<dt><strong></strong></dt><dd><p>The algorithms for floating-point, Q15, and Q31 data are slightly different and we describe each algorithm in turn. </p>
</dd>
<dt><strong>Floating-point</strong></dt><dd><p>The main functions are riscv_rfft_fast_f32() and riscv_rfft_fast_init_f32(). The older functions riscv_rfft_f32() and riscv_rfft_init_f32() have been deprecated but are still documented. For f16, the functions are riscv_rfft_fast_f16() and riscv_rfft_fast_init_f16(). For f64, the functions are riscv_rfft_fast_f64() and riscv_rfft_fast_init_f64(). </p>
</dd>
<dt><strong></strong></dt><dd><p>The FFT of a real N-point sequence has even symmetry in the frequency domain. The second half of the data equals the conjugate of the first half flipped in frequency. This conjugate part is not computed by the float RFFT. As consequence, the output of a N point real FFT should be a N//2 + 1 complex numbers so N + 2 floats. </p>
</dd>
<dt><strong></strong></dt><dd><p>It happens that the first complex of number of the RFFT output is actually all real. Its real part represents the DC offset. The value at Nyquist frequency is also real.</p>
</dd>
<dt><strong></strong></dt><dd><p>Those two complex numbers can be encoded with 2 floats rather than using two numbers with an imaginary part set to zero. </p>
</dd>
<dt><strong></strong></dt><dd><p>The implementation is using a trick so that the output buffer can be N float : the last real is packaged in the imaginary part of the first complex (since this imaginary part is not used and is zero).</p>
</dd>
<dt><strong></strong></dt><dd><p>The real FFT functions pack the frequency domain data in this fashion. The forward transform outputs the data in this form and the inverse transform expects input data in this form. The function always performs the needed bitreversal so that the input and output data is always in normal order. The functions support lengths of [32, 64, 128, …, 4096] samples. </p>
</dd>
<dt><strong>Q15 and Q31</strong></dt><dd><p>The real algorithms are defined in a similar manner and utilize N/2 complex transforms behind the scenes.</p>
</dd>
<dt><strong></strong></dt><dd><p>But warning, contrary to the float version, the fixed point implementation RFFT is also computing the conjugate part (except for MVE version) so the output buffer must be bigger. Also the fixed point RFFTs are not using any trick to pack the DC and Nyquist frequency in the same complex number. The RIFFT is not using the conjugate part but it is still using the Nyquist frequency value. The details are given in the documentation for the functions. </p>
</dd>
<dt><strong></strong></dt><dd><p>The complex transforms used internally include scaling to prevent fixed-point overflows. The overall scaling equals 1/(fftLen/2). Due to the use of complex transform internally, the source buffer is modified by the rfft. </p>
</dd>
<dt><strong></strong></dt><dd><p>A separate instance structure must be defined for each transform used but twiddle factor and bit reversal tables can be reused. </p>
</dd>
<dt><strong></strong></dt><dd><p>There is also an associated initialization function for each data type. The initialization function performs the following operations:<ul class="simple">
<li><p>Sets the values of the internal structure fields.</p></li>
<li><p>Initializes twiddle factor table and bit reversal table pointers.</p></li>
<li><p>Initializes the internal complex FFT data structure. </p></li>
</ul>
</p>
</dd>
<dt><strong></strong></dt><dd><p>Use of the initialization function is optional <strong>except for MVE versions where it is mandatory</strong>. If you don’t use the initialization functions, then the structures should be initialized with code similar to the one below:  where <code class="docutils literal notranslate"><span class="pre">fftLenReal</span></code> is the length of the real transform; <code class="docutils literal notranslate"><span class="pre">fftLenBy2</span></code> length of the internal complex transform (fftLenReal/2). <code class="docutils literal notranslate"><span class="pre">ifftFlagR</span></code> Selects forward (=0) or inverse (=1) transform. <code class="docutils literal notranslate"><span class="pre">bitReverseFlagR</span></code> Selects bit reversed output (=0) or normal order output (=1). <code class="docutils literal notranslate"><span class="pre">twidCoefRModifier</span></code> stride modifier for the twiddle factor table. The value is based on the FFT length; <code class="docutils literal notranslate"><span class="pre">pTwiddleAReal</span></code>points to the A array of twiddle coefficients; <code class="docutils literal notranslate"><span class="pre">pTwiddleBReal</span></code>points to the B array of twiddle coefficients; <code class="docutils literal notranslate"><span class="pre">pCfft</span></code> points to the CFFT Instance structure. The CFFT structure must also be initialized. </p>
</dd>
<dt><strong></strong></dt><dd><p>Note that with MVE versions you can’t initialize instance structures directly and <strong>must use the initialization function</strong>. </p>
</dd>
</dl>
</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mfcc/api_mfccq31.html" class="btn btn-neutral float-left" title="MFCC Q31" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="realfft/api_realfftf16.html" class="btn btn-neutral float-right" title="Real FFT F16 Functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-Present, Nuclei.
      <span class="lastupdated">Last updated on Jul 01, 2024.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>